!function(){"use strict";var t={309:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(161)),a=o(n(453)),u=o(n(468)),c=function(t){function e(e){var n=t.call(this,e,{duration:600,mode:u.default.RED})||this;return n.BONE_SPEED=3.5,n.timer=null,n}return i(e,t),e.prototype.start=function(){var t=this;this.timer=this.game.scheduler.scheduleInterval((function(){return t.createBones()}),40)},e.prototype.createBones=function(){var t=this.game.canvas.width/2,e=new s.default(this.game,this.BONE_SPEED);e.x=t-e.WIDTH,this.game.addObject(e);var n=new s.default(this.game,-this.BONE_SPEED);n.x=t,this.game.addObject(n)},e.prototype.stop=function(){this.timer&&this.game.scheduler.cancelInterval(this.timer)},e}(a.default);e.default=c},358:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(907)),a=o(n(453)),u=o(n(468)),c=function(t){function e(e){var n=t.call(this,e,{duration:300,mode:u.default.BLUE})||this;return n.BONE_SPEED=5,n.timer=null,n}return i(e,t),e.prototype.start=function(){var t=this;this.timer=this.game.scheduler.scheduleInterval((function(){return t.createBones()}),45)},e.prototype.createBones=function(){var t=this.game.canvas.height-40,e=new s.default(this.game,this.BONE_SPEED);e.y=0;var n=new s.default(this.game,this.BONE_SPEED);n.y=t;var r=new s.default(this.game,-this.BONE_SPEED);r.y=0;var i=new s.default(this.game,-this.BONE_SPEED);i.y=t,this.game.addObject(e),this.game.addObject(n),this.game.addObject(r),this.game.addObject(i)},e.prototype.stop=function(){this.timer&&this.game.scheduler.cancelInterval(this.timer)},e}(a.default);e.default=c},56:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(953)),a=o(n(309)),u=o(n(340)),c=o(n(567)),h=o(n(334));n(985);var l=o(n(358));Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var f=document.getElementById("game");f.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()};var p=new s.default(f);p.addAttack(a.default),p.addAttack(l.default),r(void 0,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,p.sprites.load("heart",h.default)];case 1:return t.sent(),[4,p.sprites.load("horizontalBone",u.default)];case 2:return t.sent(),[4,p.sprites.load("verticalBone",c.default)];case 3:return t.sent(),p.start(),[2]}}))}))},161:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(517)),a=o(n(687)),u=o(n(780)),c=function(t){function e(e,n){var r=t.call(this,e,{tag:u.default.ENEMY})||this;r.SPEED=n,r.WIDTH=200;var i=e.sprites.get("horizontalBone");if(!i)throw new Error("Horizontal bone sprite missing");return r.sprite=i,r.HEIGHT=i.height*(r.WIDTH/i.width),r.y=n<0?e.canvas.height:-r.HEIGHT,r}return i(e,t),e.prototype.tick=function(){this.y+=this.SPEED,(this.y<-this.HEIGHT&&this.SPEED<0||this.y>this.game.canvas.height&&this.SPEED>0)&&this.destroy()},e.prototype.render=function(t){t.imageSmoothingEnabled=!1,t.drawImage(this.sprite,this.x,this.y,this.WIDTH,this.HEIGHT)},e.prototype.getBounds=function(){return new a.default(this.x,this.y,this.WIDTH,this.HEIGHT)},e}(s.default);e.default=c},176:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(517)),a=o(n(699)),u=o(n(687)),c=o(n(468)),h=o(n(780)),l=function(t){function e(e){var n=t.call(this,e,{layer:10})||this;n.SPEED=4,n.SIZE=25,n.hurtAudio=new Audio(a.default),n.vulnerable=!0,n.transparent=!1,n.mode=c.default.RED;var r=e.canvas,i=r.width,o=r.height;n.x=i/2-n.SIZE/2,n.y=o/2-n.SIZE/2;var s=e.sprites.get("heart");if(!s)throw new Error("Heart sprite missing");return n.sprite=s,n}return i(e,t),e.prototype.tick=function(){var t=this;if(this.mode.controller.tick(this),this.vulnerable)for(var e=this.getBounds(),n=function(n){if(n.options.tag!==h.default.ENEMY||!n.getBounds().collide(e))return"continue";r.vulnerable=!1,r.transparent=!0,r.hurtAudio.play();var i=r.game.scheduler,o=i.scheduleInterval((function(){t.transparent=!t.transparent}),10);return i.schedule((function(){i.cancelInterval(o),t.vulnerable=!0,t.transparent=!1}),60),"break"},r=this,i=0,o=this.game.objects;i<o.length&&"break"!==n(o[i]);i++);},e.prototype.render=function(t){t.imageSmoothingEnabled=!1,t.filter="hue-rotate("+this.mode.hue+"deg)",this.transparent&&(t.globalAlpha=.5),t.drawImage(this.sprite,this.x,this.y,this.SIZE,this.SIZE),t.filter="none",t.globalAlpha=1},e.prototype.getBounds=function(){return new u.default(this.x,this.y,this.SIZE,this.SIZE)},e}(s.default);e.default=l},907:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(517)),a=o(n(687)),u=o(n(780)),c=function(t){function e(e,n){var r=t.call(this,e,{tag:u.default.ENEMY})||this;r.SPEED=n,r.HEIGHT=200;var i=e.sprites.get("verticalBone");if(!i)throw new Error("Vertical bone sprite missing");return r.WIDTH=i.width*(r.HEIGHT/i.height),r.x=n<0?e.canvas.width:-r.WIDTH,r.sprite=i,r}return i(e,t),e.prototype.tick=function(){this.x+=this.SPEED,(this.x<-this.WIDTH&&this.SPEED<0||this.x>this.game.canvas.width&&this.SPEED>0)&&this.destroy()},e.prototype.render=function(t){t.imageSmoothingEnabled=!1,t.drawImage(this.sprite,this.x,this.y,this.WIDTH,this.HEIGHT)},e.prototype.getBounds=function(){return new a.default(this.x,this.y,this.WIDTH,this.HEIGHT)},e}(s.default);e.default=c},453:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.game=t,this.duration=e.duration,this.mode=e.mode}},517:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===e&&(e={}),this.game=t,this.options=e,this.x=0,this.y=0}return t.prototype.destroy=function(){this.game.removeObject(this)},t}();e.default=n},953:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(176)),o=r(n(312)),s=r(n(12)),a=r(n(574)),u=function(){function t(t){this.canvas=t,this._player=null,this.controls=new o.default,this.scheduler=new s.default,this.sprites=new a.default,this.attacks=[],this._objects=[],this.update=this.update.bind(this)}return t.prototype.start=function(){var t=this;this._player=new i.default(this),this.addObject(this._player),requestAnimationFrame(this.update),this.scheduler.schedule((function(){return t.nextAttack()}),60)},t.prototype.update=function(){this.scheduler.tick();for(var t=0,e=this._objects;t<e.length;t++)e[t].tick(this);var n=this.canvas,r=n.width,i=n.height,o=this.canvas.getContext("2d"),s=this._objects.sort((function(t,e){return(t.options.layer||0)-(e.options.layer||0)}));o.clearRect(0,0,r,i);for(var a=0,u=s;a<u.length;a++)u[a].render(o);requestAnimationFrame(this.update)},t.prototype.nextAttack=function(){var t=this;if(this.attacks.length&&this._player){var e=new(0,this.attacks[Math.floor(Math.random()*this.attacks.length)])(this);this._player.mode=e.mode,e.start(),this.scheduler.schedule((function(){e.stop(),t.scheduler.schedule((function(){return t.nextAttack()}),60)}),e.duration)}},t.prototype.addAttack=function(t){this.attacks.push(t)},t.prototype.addObject=function(t){this._objects.push(t)},t.prototype.removeObject=function(t){this._objects=this._objects.filter((function(e){return e!==t}))},Object.defineProperty(t.prototype,"objects",{get:function(){return this._objects},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"player",{get:function(){return this._player},enumerable:!1,configurable:!0}),t}();e.default=u},312:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;this.keys=new Map,document.addEventListener("keydown",(function(e){return t.handleKeyPress(e)})),document.addEventListener("keyup",(function(e){return t.handleKeyUp(e)})),window.addEventListener("blur",(function(){return t.handleBlur()}))}return t.prototype.isKeyDown=function(t){var e;return null!==(e=this.keys.get(t))&&void 0!==e&&e},t.prototype.handleKeyPress=function(t){this.keys.set(t.key,!0)},t.prototype.handleKeyUp=function(t){this.keys.set(t.key,!1)},t.prototype.handleBlur=function(){this.keys.clear()},t}();e.default=n},468:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(807)),o=r(n(710)),s=function(){function t(t,e){this.hue=t,this.controller=e}return t.RED=new t(0,new i.default),t.BLUE=new t(240,new o.default),t}();e.default=s},730:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){}},710:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GRAVITY=.23,e.JUMP_FORCE=6,e.MAX_JUMP_TICKS=15,e.verticalSpeed=0,e.grounded=!1,e.jumpTicksLeft=0,e}return i(e,t),e.prototype.tick=function(t){var e=t.game,n=e.controls,r=e.canvas,i=t.SPEED,o=t.SIZE,s=n.isKeyDown("ArrowUp")||n.isKeyDown("w"),a=n.isKeyDown("ArrowLeft")||n.isKeyDown("a"),u=n.isKeyDown("ArrowRight")||n.isKeyDown("d");a&&(t.x-=i),u&&(t.x+=i),this.grounded||(this.verticalSpeed+=this.GRAVITY),t.y+=this.verticalSpeed,t.y>=r.height-o&&(this.grounded=!0),s?(this.grounded&&(this.jumpTicksLeft=this.MAX_JUMP_TICKS,this.grounded=!1),this.jumpTicksLeft>0&&(this.verticalSpeed=-this.JUMP_FORCE,this.jumpTicksLeft--)):this.jumpTicksLeft>0&&(this.verticalSpeed=.2*-(this.MAX_JUMP_TICKS-this.jumpTicksLeft),this.jumpTicksLeft=0),t.x=Math.clamp(t.x,0,r.width-o),t.y=Math.clamp(t.y,0,r.height-o)},e}(o(n(730)).default);e.default=s},807:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.tick=function(t){var e=t.game,n=e.controls,r=e.canvas,i=t.SPEED,o=t.SIZE,s=n.isKeyDown("ArrowUp")||n.isKeyDown("w"),a=n.isKeyDown("ArrowLeft")||n.isKeyDown("a"),u=n.isKeyDown("ArrowDown")||n.isKeyDown("s"),c=n.isKeyDown("ArrowRight")||n.isKeyDown("d");s&&(t.y-=i),a&&(t.x-=i),u&&(t.y+=i),c&&(t.x+=i),t.x=Math.clamp(t.x,0,r.width-o),t.y=Math.clamp(t.y,0,r.height-o)},e}(o(n(730)).default);e.default=s},687:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r,this.endX=t+n,this.endY=e+r}return t.prototype.collide=function(t){var e=this.endX<t.x,n=this.x>t.endX,r=this.endY<t.y,i=this.y>t.endY;return!(e||n||r||i)},t}();e.default=n},12:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.schedules=new Map,this.intervals=new Map,this._time=0,this.taskID=1}return t.prototype.tick=function(){this._time++;for(var t=0,e=Array.from(this.schedules.entries());t<e.length;t++){var n=e[t],r=n[0],i=n[1];this._time<i.runAt||(i.run(),this.schedules.delete(r))}for(var o=0,s=Array.from(this.intervals.values());o<s.length;o++)i=s[o],this._time<i.runAt||(i.run(),i.runAt+=i.interval)},t.prototype.schedule=function(t,e){this.taskID++;var n={run:t,runAt:this._time+e};return this.schedules.set(this.taskID,n),this.taskID},t.prototype.scheduleInterval=function(t,e,n){this.taskID++;var r={run:t,interval:null!=n?n:e,runAt:this._time+e};return this.intervals.set(this.taskID,r),this.taskID},t.prototype.cancelSchedule=function(t){return this.schedules.delete(t)},t.prototype.cancelInterval=function(t){return this.intervals.delete(t)},Object.defineProperty(t.prototype,"time",{get:function(){return this._time},enumerable:!1,configurable:!0}),t}();e.default=n},574:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.sprites=new Map}return t.prototype.load=function(t,e){var n=this;return new Promise((function(r,i){var o=new Image;o.src=e,o.onload=function(){n.sprites.set(t,o),r(o)},o.onerror=function(t){return i(t)}}))},t.prototype.get=function(t){return this.sprites.get(t)},t}();e.default=n},780:function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.PLAYER=0]="PLAYER",t[t.NEUTRAL=1]="NEUTRAL",t[t.ENEMY=2]="ENEMY"}(n||(n={})),e.default=n},334:function(t,e,n){n.r(e),e.default="/canvas-game/img/heart.png"},340:function(t,e,n){n.r(e),e.default="/canvas-game/img/horizontal-bone.png"},567:function(t,e,n){n.r(e),e.default="/canvas-game/img/vertical-bone.png"},699:function(t,e,n){n.r(e),e.default="/canvas-game/sound/hurt.mp3"},985:function(t,e,n){n.r(e)}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(56)}();
//# sourceMappingURL=main.05e1f290.js.map