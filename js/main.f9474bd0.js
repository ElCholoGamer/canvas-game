!function(){"use strict";var t={309:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(161)),u=function(t){function e(e){var n=t.call(this,e,600)||this;return n.BONE_SPEED=3.5,n.timer=null,n}return i(e,t),e.prototype.start=function(){var t=this;this.timer=this.game.scheduler.scheduleInterval((function(){return t.addBones()}),40)},e.prototype.addBones=function(){var t=this.game.canvas.width/2,e=new s.default(this.game,t-200,this.BONE_SPEED);this.game.addObject(e);var n=new s.default(this.game,t,-this.BONE_SPEED);this.game.addObject(n)},e.prototype.stop=function(){this.timer&&this.game.scheduler.cancelInterval(this.timer)},e}(o(n(453)).default);e.default=u},56:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(953)),u=o(n(309)),a=o(n(752)),h=o(n(334));n(985),Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var c=document.getElementById("game");c.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()};var l=new s.default(c);l.addAttack(u.default),r(void 0,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,l.sprites.load("heart",h.default)];case 1:return t.sent(),[4,l.sprites.load("horizontalBone",a.default)];case 2:return t.sent(),l.start(),[2]}}))}))},161:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(517)),u=o(n(687)),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.SPEED=r,i.WIDTH=200;var o=e.sprites.get("horizontalBone");if(!o)throw new Error("Horizontal bone sprite missing");return i.sprite=o,i.HEIGHT=i.sprite.height*(i.WIDTH/i.sprite.width),i.x=n,i.y=r<0?e.canvas.height:-i.HEIGHT,i}return i(e,t),e.prototype.tick=function(){this.y+=this.SPEED,(this.y<-this.HEIGHT&&this.SPEED<0||this.y>this.game.canvas.height&&this.SPEED>0)&&this.destroy()},e.prototype.render=function(t){t.imageSmoothingEnabled=!1,t.drawImage(this.sprite,this.x,this.y,this.WIDTH,this.HEIGHT)},e.prototype.getBounds=function(){return new u.default(this.x,this.y,this.WIDTH,this.HEIGHT)},e}(s.default);e.default=a},176:function(t,e,n){var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(n(517)),u=o(n(699)),a=o(n(161)),h=o(n(687)),c=function(t){function e(e){var n=t.call(this,e,10)||this;n.SIZE=25,n.SPEED=4,n.hurtAudio=new Audio(u.default),n.vulnerable=!0;var r=e.canvas,i=r.width,o=r.height;n.x=i/2-n.SIZE/2,n.y=o/2-n.SIZE/2;var s=e.sprites.get("heart");if(!s)throw new Error("Heart sprite missing");return n.sprite=s,n}return i(e,t),e.prototype.tick=function(){var t=this,e=this.game,n=e.controls,r=e.canvas,i=n.isKeyDown("ArrowUp")||n.isKeyDown("w"),o=n.isKeyDown("ArrowLeft")||n.isKeyDown("a"),s=n.isKeyDown("ArrowDown")||n.isKeyDown("s"),u=n.isKeyDown("ArrowRight")||n.isKeyDown("d");if(i&&(this.y-=this.SPEED),o&&(this.x-=this.SPEED),s&&(this.y+=this.SPEED),u&&(this.x+=this.SPEED),this.x=Math.clamp(this.x,0,r.width-this.SIZE),this.y=Math.clamp(this.y,0,r.height-this.SIZE),this.vulnerable)for(var h=this.getBounds(),c=0,l=this.game.objects;c<l.length;c++){var f=l[c];if(f instanceof a.default&&f.getBounds().collide(h)){this.vulnerable=!1,this.hurtAudio.play(),this.game.scheduler.schedule((function(){t.vulnerable=!0}),30);break}}},e.prototype.render=function(t){t.imageSmoothingEnabled=!1,t.drawImage(this.sprite,this.x,this.y,this.SIZE,this.SIZE)},e.prototype.getBounds=function(){return new h.default(this.x,this.y,this.SIZE,this.SIZE)},e}(s.default);e.default=c},453:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.game=t,this.duration=e}},535:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;this.keys=new Map,document.addEventListener("keydown",(function(e){return t.handleKeyPress(e)})),document.addEventListener("keyup",(function(e){return t.handleKeyUp(e)})),window.addEventListener("blur",(function(){return t.handleBlur()}))}return t.prototype.isKeyDown=function(t){var e;return null!==(e=this.keys.get(t))&&void 0!==e&&e},t.prototype.handleKeyPress=function(t){this.keys.set(t.key,!0)},t.prototype.handleKeyUp=function(t){this.keys.set(t.key,!1)},t.prototype.handleBlur=function(){this.keys.clear()},t}();e.default=n},517:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,r){return this.game=t,void 0!==r?(this.x=e||0,this.y=n||0,void(this.LAYER=r)):void 0!==n?(this.x=e||0,this.y=n||0,void(this.LAYER=0)):(this.x=0,this.y=0,void(this.LAYER=e||0))}return t.prototype.destroy=function(){this.game.removeObject(this)},t}();e.default=n},953:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(176)),o=r(n(535)),s=r(n(12)),u=r(n(574)),a=function(){function t(t){this.canvas=t,this.controls=new o.default,this.scheduler=new s.default,this.sprites=new u.default,this.attacks=[],this._objects=[],this.update=this.update.bind(this)}return t.prototype.start=function(){var t=this;this.addObject(new i.default(this)),requestAnimationFrame(this.update),this.scheduler.schedule((function(){return t.nextAttack()}),60)},t.prototype.update=function(){this.scheduler.tick();for(var t=0,e=this._objects;t<e.length;t++)e[t].tick(this);var n=this.canvas,r=n.width,i=n.height,o=this.canvas.getContext("2d"),s=this._objects.sort((function(t,e){return t.LAYER-e.LAYER}));o.clearRect(0,0,r,i);for(var u=0,a=s;u<a.length;u++)a[u].render(o);requestAnimationFrame(this.update)},t.prototype.nextAttack=function(){var t=this;if(this.attacks.length){var e=new(0,this.attacks[Math.floor(Math.random()*this.attacks.length)])(this);e.start(),this.scheduler.schedule((function(){e.stop(),t.scheduler.schedule((function(){return t.nextAttack()}),60)}),e.duration)}},t.prototype.addAttack=function(t){this.attacks.push(t)},t.prototype.addObject=function(t){this._objects.push(t)},t.prototype.removeObject=function(t){this._objects=this._objects.filter((function(e){return e!==t}))},Object.defineProperty(t.prototype,"objects",{get:function(){return this._objects},enumerable:!1,configurable:!0}),t}();e.default=a},687:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r,this.endX=t+n,this.endY=e+r}return t.prototype.collide=function(t){var e=this.endX<t.x,n=this.x>t.endX,r=this.endY<t.y,i=this.y>t.endY;return!(e||n||r||i)},t}();e.default=n},12:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.schedules=new Map,this.intervals=new Map,this._time=0,this.taskID=1}return t.prototype.tick=function(){this._time++;for(var t=0,e=Array.from(this.schedules.entries());t<e.length;t++){var n=e[t],r=n[0],i=n[1];this._time<i.runAt||(i.run(),this.schedules.delete(r))}for(var o=0,s=Array.from(this.intervals.values());o<s.length;o++)i=s[o],this._time<i.runAt||(i.run(),i.runAt+=i.interval)},t.prototype.schedule=function(t,e){this.taskID++;var n={run:t,runAt:this._time+e};return this.schedules.set(this.taskID,n),this.taskID},t.prototype.scheduleInterval=function(t,e,n){this.taskID++;var r={run:t,interval:null!=n?n:e,runAt:this._time+e};return this.intervals.set(this.taskID,r),this.taskID},t.prototype.cancelSchedule=function(t){return this.schedules.delete(t)},t.prototype.cancelInterval=function(t){return this.intervals.delete(t)},Object.defineProperty(t.prototype,"time",{get:function(){return this._time},enumerable:!1,configurable:!0}),t}();e.default=n},574:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.sprites=new Map}return t.prototype.load=function(t,e){var n=this;return new Promise((function(r,i){var o=new Image;o.src=e,o.onload=function(){n.sprites.set(t,o),r(o)},o.onerror=function(t){return i(t)}}))},t.prototype.get=function(t){return this.sprites.get(t)},t}();e.default=n},752:function(t,e,n){n.r(e),e.default="/canvas-game/img/bone.png"},334:function(t,e,n){n.r(e),e.default="/canvas-game/img/heart.png"},699:function(t,e,n){n.r(e),e.default="/canvas-game/sound/hurt.mp3"},985:function(t,e,n){n.r(e)}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(56)}();
//# sourceMappingURL=main.f9474bd0.js.map