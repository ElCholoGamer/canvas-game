{"version":3,"sources":["webpack://canvas-game/./src/attacks/bone-elevator.ts","webpack://canvas-game/./src/index.ts","webpack://canvas-game/./src/objects/horizontal-bone.ts","webpack://canvas-game/./src/objects/player.ts","webpack://canvas-game/./src/structures/attack.ts","webpack://canvas-game/./src/structures/control-manager.ts","webpack://canvas-game/./src/structures/game-object.ts","webpack://canvas-game/./src/structures/game.ts","webpack://canvas-game/./src/structures/rect-bounds.ts","webpack://canvas-game/./src/structures/scheduler.ts","webpack://canvas-game/./src/structures/sprite-manager.ts","webpack://canvas-game/./src/assets/img/bone.png","webpack://canvas-game/./src/assets/img/heart.png","webpack://canvas-game/./src/assets/sound/hurt.mp3","webpack://canvas-game/webpack/bootstrap","webpack://canvas-game/webpack/runtime/make namespace object","webpack://canvas-game/webpack/startup"],"names":["game","BONE_SPEED","timer","start","this","scheduler","scheduleInterval","addBones","half","canvas","width","downBone","addObject","upBone","stop","cancelInterval","BoneElevator","Math","clamp","n","min","max","document","getElementById","oncontextmenu","e","preventDefault","stopPropagation","addAttack","sprites","load","x","SPEED","WIDTH","bone","get","Error","sprite","HEIGHT","height","y","tick","destroy","render","ctx","imageSmoothingEnabled","drawImage","getBounds","HorizontalBone","SIZE","hurtAudio","Audio","vulnerable","heart","controls","up","isKeyDown","left","down","right","bounds","objects","obj","collide","play","schedule","Player","duration","keys","Map","addEventListener","handleKeyPress","handleKeyUp","window","key","set","handleBlur","clear","ControlManager","xOrLayer","LAYER","undefined","removeObject","GameObject","attacks","_objects","update","bind","requestAnimationFrame","getContext","sorted","sort","a","b","clearRect","nextAttack","length","attack","ctor","floor","random","push","filter","o","Game","endX","endY","rect","isLeft","isRight","isAbove","isBelow","RectBounds","schedules","intervals","_time","taskID","Array","from","entries","id","task","runAt","run","values","interval","fn","ticks","initialDelay","cancelSchedule","Scheduler","src","Promise","resolve","reject","Image","onload","onerror","SpriteManager","__webpack_module_cache__","__webpack_require__","moduleId","exports","module","__webpack_modules__","call","r","Symbol","toStringTag","Object","defineProperty","value"],"mappings":"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","file":"js/main.f9474bd0.js","sourcesContent":["import HorizontalBone from '../objects/horizontal-bone';\nimport Attack from '../structures/attack';\nimport Game from '../structures/game';\n\nclass BoneElevator extends Attack {\n\tprivate readonly BONE_SPEED = 3.5;\n\n\tprivate timer: number | null = null;\n\n\tpublic constructor(game: Game) {\n\t\tsuper(game, 600);\n\t}\n\n\tpublic start() {\n\t\tthis.timer = this.game.scheduler.scheduleInterval(\n\t\t\t() => this.addBones(),\n\t\t\t40\n\t\t);\n\t}\n\n\tprivate addBones() {\n\t\tconst BONE_WIDTH = 200;\n\n\t\tconst half = this.game.canvas.width / 2;\n\n\t\tconst downBone = new HorizontalBone(\n\t\t\tthis.game,\n\t\t\thalf - BONE_WIDTH,\n\t\t\tthis.BONE_SPEED\n\t\t);\n\t\tthis.game.addObject(downBone);\n\n\t\tconst upBone = new HorizontalBone(this.game, half, -this.BONE_SPEED);\n\t\tthis.game.addObject(upBone);\n\t}\n\n\tpublic stop() {\n\t\tif (this.timer) {\n\t\t\tthis.game.scheduler.cancelInterval(this.timer);\n\t\t}\n\t}\n}\n\nexport default BoneElevator;\n","import Game from './structures/game';\nimport BoneElevator from './attacks/bone-elevator';\nimport BoneSprite from './assets/img/bone.png';\nimport HeartSprite from './assets/img/heart.png';\nimport './index.css';\n\nMath.clamp = function (n, min, max) {\n\treturn Math.max(min, Math.min(n, max));\n};\n\nconst canvas = document.getElementById('game') as HTMLCanvasElement;\n\ncanvas.oncontextmenu = e => {\n\te.preventDefault();\n\te.stopPropagation();\n};\n\nconst game = new Game(canvas);\ngame.addAttack(BoneElevator);\n\n(async () => {\n\tawait game.sprites.load('heart', HeartSprite);\n\tawait game.sprites.load('horizontalBone', BoneSprite);\n\n\tgame.start();\n})();\n","import GameObject from '../structures/game-object';\nimport Game from '../structures/game';\nimport RectBounds from '../structures/rect-bounds';\n\nclass HorizontalBone extends GameObject {\n\tpublic readonly WIDTH = 200;\n\tpublic readonly HEIGHT;\n\n\tprivate readonly sprite: HTMLImageElement;\n\n\tpublic constructor(game: Game, x: number, private readonly SPEED: number) {\n\t\tsuper(game);\n\n\t\tconst bone = game.sprites.get('horizontalBone');\n\t\tif (!bone) throw new Error('Horizontal bone sprite missing');\n\n\t\tthis.sprite = bone;\n\n\t\tthis.HEIGHT = this.sprite.height * (this.WIDTH / this.sprite.width);\n\n\t\tthis.x = x;\n\t\tthis.y = SPEED < 0 ? game.canvas.height : -this.HEIGHT;\n\t}\n\n\tpublic tick() {\n\t\tthis.y += this.SPEED;\n\n\t\tif (\n\t\t\t(this.y < -this.HEIGHT && this.SPEED < 0) ||\n\t\t\t(this.y > this.game.canvas.height && this.SPEED > 0)\n\t\t) {\n\t\t\tthis.destroy();\n\t\t}\n\t}\n\n\tpublic render(ctx: CanvasRenderingContext2D) {\n\t\tctx.imageSmoothingEnabled = false;\n\t\tctx.drawImage(this.sprite, this.x, this.y, this.WIDTH, this.HEIGHT);\n\t}\n\n\tpublic getBounds() {\n\t\treturn new RectBounds(this.x, this.y, this.WIDTH, this.HEIGHT);\n\t}\n}\n\nexport default HorizontalBone;\n","import Game from '../structures/game';\nimport GameObject from '../structures/game-object';\nimport HurtAudio from '../assets/sound/hurt.mp3';\nimport HorizontalBone from './horizontal-bone';\nimport RectBounds from '../structures/rect-bounds';\n\nclass Player extends GameObject {\n\tprivate readonly SIZE = 25;\n\tprivate readonly SPEED = 4;\n\n\tprivate readonly sprite;\n\tprivate readonly hurtAudio = new Audio(HurtAudio);\n\n\tprivate vulnerable = true;\n\n\tpublic constructor(game: Game) {\n\t\tsuper(game, 10);\n\n\t\tconst { width, height } = game.canvas;\n\t\tthis.x = width / 2 - this.SIZE / 2;\n\t\tthis.y = height / 2 - this.SIZE / 2;\n\n\t\tconst heart = game.sprites.get('heart');\n\t\tif (!heart) throw new Error('Heart sprite missing');\n\n\t\tthis.sprite = heart;\n\t}\n\n\tpublic tick() {\n\t\tconst { controls, canvas } = this.game;\n\n\t\tconst up = controls.isKeyDown('ArrowUp') || controls.isKeyDown('w');\n\t\tconst left = controls.isKeyDown('ArrowLeft') || controls.isKeyDown('a');\n\t\tconst down = controls.isKeyDown('ArrowDown') || controls.isKeyDown('s');\n\t\tconst right = controls.isKeyDown('ArrowRight') || controls.isKeyDown('d');\n\n\t\tif (up) this.y -= this.SPEED;\n\t\tif (left) this.x -= this.SPEED;\n\t\tif (down) this.y += this.SPEED;\n\t\tif (right) this.x += this.SPEED;\n\n\t\tthis.x = Math.clamp(this.x, 0, canvas.width - this.SIZE);\n\t\tthis.y = Math.clamp(this.y, 0, canvas.height - this.SIZE);\n\n\t\t// Check bone collisions\n\t\tif (this.vulnerable) {\n\t\t\tconst bounds = this.getBounds();\n\n\t\t\tfor (const obj of this.game.objects) {\n\t\t\t\tif (\n\t\t\t\t\t!(obj instanceof HorizontalBone) ||\n\t\t\t\t\t!obj.getBounds().collide(bounds)\n\t\t\t\t)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis.vulnerable = false;\n\t\t\t\tthis.hurtAudio.play();\n\t\t\t\tthis.game.scheduler.schedule(() => {\n\t\t\t\t\tthis.vulnerable = true;\n\t\t\t\t}, 30);\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic render(ctx: CanvasRenderingContext2D) {\n\t\tctx.imageSmoothingEnabled = false;\n\t\tctx.drawImage(this.sprite, this.x, this.y, this.SIZE, this.SIZE);\n\t}\n\n\tpublic getBounds() {\n\t\treturn new RectBounds(this.x, this.y, this.SIZE, this.SIZE);\n\t}\n}\n\nexport default Player;\n","import Game from './game';\n\nabstract class Attack {\n\tpublic constructor(\n\t\tprotected readonly game: Game,\n\t\tpublic readonly duration: number\n\t) {}\n\n\tpublic abstract start(): void;\n\tpublic abstract stop(): void;\n}\n\nexport default Attack;\n","class ControlManager {\n\tprivate readonly keys = new Map<string, boolean>();\n\n\tpublic constructor() {\n\t\tdocument.addEventListener('keydown', e => this.handleKeyPress(e));\n\t\tdocument.addEventListener('keyup', e => this.handleKeyUp(e));\n\t\twindow.addEventListener('blur', () => this.handleBlur());\n\t}\n\n\tpublic isKeyDown(key: string): boolean {\n\t\treturn this.keys.get(key) ?? false;\n\t}\n\n\tprivate handleKeyPress(e: KeyboardEvent) {\n\t\tthis.keys.set(e.key, true);\n\t}\n\n\tprivate handleKeyUp(e: KeyboardEvent) {\n\t\tthis.keys.set(e.key, false);\n\t}\n\n\tprivate handleBlur() {\n\t\tthis.keys.clear();\n\t}\n}\n\nexport default ControlManager;\n","import Game from './game';\nimport RectBounds from './rect-bounds';\n\nabstract class GameObject {\n\tpublic readonly LAYER: number;\n\tpublic x: number;\n\tpublic y: number;\n\n\tpublic constructor(game: Game);\n\tpublic constructor(game: Game, layer: number);\n\tpublic constructor(game: Game, x: number, y: number);\n\tpublic constructor(game: Game, x: number, y: number, layer: number);\n\tpublic constructor(game: Game, x: number, y: number, layer: number);\n\tpublic constructor(\n\t\tprotected readonly game: Game,\n\t\txOrLayer?: number,\n\t\ty?: number,\n\t\tLAYER?: number\n\t) {\n\t\tif (LAYER !== undefined) {\n\t\t\tthis.x = xOrLayer || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.LAYER = LAYER;\n\t\t\treturn;\n\t\t}\n\n\t\tif (y !== undefined) {\n\t\t\tthis.x = xOrLayer || 0;\n\t\t\tthis.y = y || 0;\n\t\t\tthis.LAYER = 0;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.LAYER = xOrLayer || 0;\n\t}\n\n\tpublic abstract tick(game: Game): void;\n\tpublic abstract render(ctx: CanvasRenderingContext2D): void;\n\tpublic abstract getBounds(): RectBounds;\n\n\tpublic destroy() {\n\t\tthis.game.removeObject(this);\n\t}\n}\n\nexport default GameObject;\n","import Player from '../objects/player';\nimport Attack from './attack';\nimport ControlManager from './control-manager';\nimport GameObject from './game-object';\nimport Scheduler from './scheduler';\nimport SpriteManager from './sprite-manager';\n\ntype AttackConstructor = new (game: Game) => Attack;\n\nclass Game {\n\tpublic readonly controls = new ControlManager();\n\tpublic readonly scheduler = new Scheduler();\n\tpublic readonly sprites = new SpriteManager();\n\n\tprivate readonly attacks: AttackConstructor[] = [];\n\tprivate _objects: GameObject[] = [];\n\n\tpublic constructor(public readonly canvas: HTMLCanvasElement) {\n\t\tthis.update = this.update.bind(this);\n\t}\n\n\tpublic start() {\n\t\tthis.addObject(new Player(this));\n\n\t\trequestAnimationFrame(this.update);\n\t\tthis.scheduler.schedule(() => this.nextAttack(), 60);\n\t}\n\n\tprivate update() {\n\t\tthis.scheduler.tick();\n\n\t\t// Tick objects\n\t\tfor (const obj of this._objects) {\n\t\t\tobj.tick(this);\n\t\t}\n\n\t\tconst { width, height } = this.canvas;\n\t\tconst ctx = this.canvas.getContext('2d')!;\n\n\t\t// Render objects\n\t\tconst sorted = this._objects.sort((a, b) => a.LAYER - b.LAYER);\n\t\tctx.clearRect(0, 0, width, height);\n\n\t\tfor (const obj of sorted) {\n\t\t\tobj.render(ctx);\n\t\t}\n\n\t\trequestAnimationFrame(this.update);\n\t}\n\n\tprivate nextAttack() {\n\t\tif (!this.attacks.length) return;\n\n\t\tconst ctor = this.attacks[Math.floor(Math.random() * this.attacks.length)];\n\t\tconst attack = new ctor(this);\n\n\t\tattack.start();\n\t\tthis.scheduler.schedule(() => {\n\t\t\tattack.stop();\n\t\t\tthis.scheduler.schedule(() => this.nextAttack(), 60);\n\t\t}, attack.duration);\n\t}\n\n\tpublic addAttack(ctor: AttackConstructor) {\n\t\tthis.attacks.push(ctor);\n\t}\n\n\tpublic addObject(obj: GameObject) {\n\t\tthis._objects.push(obj);\n\t}\n\n\tpublic removeObject(obj: GameObject) {\n\t\tthis._objects = this._objects.filter(o => o !== obj);\n\t}\n\n\tpublic get objects(): ReadonlyArray<GameObject> {\n\t\treturn this._objects;\n\t}\n}\n\nexport default Game;\n","class RectBounds {\n\tpublic endX: number;\n\tpublic endY: number;\n\n\tpublic constructor(\n\t\tpublic x: number,\n\t\tpublic y: number,\n\t\tpublic width: number,\n\t\tpublic height: number\n\t) {\n\t\tthis.endX = x + width;\n\t\tthis.endY = y + height;\n\t}\n\n\tpublic collide(rect: RectBounds) {\n\t\tconst isLeft = this.endX < rect.x;\n\t\tconst isRight = this.x > rect.endX;\n\t\tconst isAbove = this.endY < rect.y;\n\t\tconst isBelow = this.y > rect.endY;\n\n\t\treturn !isLeft && !isRight && !isAbove && !isBelow;\n\t}\n}\n\nexport default RectBounds;\n","type Runnable = () => void;\n\nexport interface Task {\n\trun: Runnable;\n\trunAt: number;\n}\n\nexport interface IntervalTask extends Task {\n\tinterval: number;\n}\n\nclass Scheduler {\n\tprivate schedules = new Map<number, Task>();\n\tprivate intervals = new Map<number, IntervalTask>();\n\n\tprivate _time = 0;\n\tprivate taskID = 1;\n\n\tpublic tick() {\n\t\tthis._time++;\n\n\t\tconst tasks = Array.from(this.schedules.entries());\n\t\tfor (const [id, task] of tasks) {\n\t\t\tif (this._time < task.runAt) continue;\n\n\t\t\ttask.run();\n\t\t\tthis.schedules.delete(id);\n\t\t}\n\n\t\tconst intervalTasks = Array.from(this.intervals.values());\n\t\tfor (const task of intervalTasks) {\n\t\t\tif (this._time < task.runAt) continue;\n\n\t\t\ttask.run();\n\t\t\ttask.runAt += task.interval;\n\t\t}\n\t}\n\n\tpublic schedule(fn: Runnable, ticks: number): number {\n\t\tthis.taskID++;\n\n\t\tconst task: Task = {\n\t\t\trun: fn,\n\t\t\trunAt: this._time + ticks,\n\t\t};\n\n\t\tthis.schedules.set(this.taskID, task);\n\t\treturn this.taskID;\n\t}\n\n\tpublic scheduleInterval(fn: Runnable, interval: number): number;\n\tpublic scheduleInterval(\n\t\tfn: Runnable,\n\t\tinitialDelay: number,\n\t\tinterval: number\n\t): number;\n\tpublic scheduleInterval(\n\t\tfn: Runnable,\n\t\tinitialDelay: number,\n\t\tinterval?: number\n\t): number {\n\t\tthis.taskID++;\n\n\t\tconst task: IntervalTask = {\n\t\t\trun: fn,\n\t\t\tinterval: interval ?? initialDelay,\n\t\t\trunAt: this._time + initialDelay,\n\t\t};\n\n\t\tthis.intervals.set(this.taskID, task);\n\t\treturn this.taskID;\n\t}\n\n\tpublic cancelSchedule(id: number) {\n\t\treturn this.schedules.delete(id);\n\t}\n\n\tpublic cancelInterval(id: number) {\n\t\treturn this.intervals.delete(id);\n\t}\n\n\tpublic get time() {\n\t\treturn this._time;\n\t}\n}\n\nexport default Scheduler;\n","class SpriteManager {\n\tprivate readonly sprites = new Map<string, HTMLImageElement>();\n\n\tpublic load(key: string, src: string) {\n\t\treturn new Promise<HTMLImageElement>((resolve, reject) => {\n\t\t\tconst sprite = new Image();\n\t\t\tsprite.src = src;\n\n\t\t\tsprite.onload = () => {\n\t\t\t\tthis.sprites.set(key, sprite);\n\t\t\t\tresolve(sprite);\n\t\t\t};\n\t\t\tsprite.onerror = e => reject(e);\n\t\t});\n\t}\n\n\tpublic get(key: string) {\n\t\treturn this.sprites.get(key);\n\t}\n}\n\nexport default SpriteManager;\n","export default \"/canvas-game/img/bone.png\";","export default \"/canvas-game/img/heart.png\";","export default \"/canvas-game/sound/hurt.mp3\";","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(56);\n"],"sourceRoot":""}